// See pug/index.pug.
doctype html

html(lang='en')
  head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible' content='IE=edge')
    meta(name='viewport' content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no')

    //- Bootstrap 3.4.1
    link(rel='stylesheet' type='text/css' href='src/bootstrap/bootstrap.min.css')
    link(rel='stylesheet' type='text/css' href='src/bootstrap/bootstrap-theme.min.css')
    script(src='src/bootstrap/jquery-3.5.0.min.js')
    script(src='src/bootstrap/bootstrap.min.js')

    link(rel='stylesheet' type='text/css' href='src/css/app.css')

    script(src='https://cdn.jsdelivr.net/npm/vue/dist/vue.js')
    script(src='//cwilso.github.io/AudioContext-MonkeyPatch/AudioContextMonkeyPatch.js')
    script(src='dist/bundle.js')

  body
    div.container-fluid#vueApp
      div#controls
        div#tempoBox
          div#tempoEditButtons
            a(v-on:click='metronomeTempoHalve()') รท2
            a(v-on:click='metronomeTempoDecrementBy10()') -10
            a(v-on:click='metronomeTempoDecrementBy5()') -5
            a(v-on:click='metronomeTempoDecrement()') -1
            a(v-on:click='metronomeTempoIncrement()') +1
            a(v-on:click='metronomeTempoIncrementBy5()') +5
            a(v-on:click='metronomeTempoIncrementBy10()') +10
            a(v-on:click='metronomeTempoDouble()') ร2
          input(
              name='tempo' id='tempo'
              type='number' min='0' step='1' pattern='[0-9]*' inputmode='numeric'
              title='beats per minute' placeholder='beats per minute'
              v-model="metronome.tempo" v-on:change="metronomeStop()")
        div Resolution:
          select(v-model="metronome.noteResolution")
            option(v-bind:value="0" selected) quarter
            option(v-bind:value="1") 8th
            option(v-bind:value="2") 16th
        div
          a(v-on:click='metronomeToggle()') {{ metronome.toggleLabel }}
      div
        div
          | Measure counter:
          span {{ songChart.curRunningMeasures }}
        div
          div
            span {{ songChart.name }}
            | -
            span {{ songChart.artist }}
          | Current section:
          span {{ songChart.curSectionName }}
          div 
            span {{ songChart.curMeasure }}
            | .
            span {{ songChart.curBeat }}
            | /
            span {{ songChart.curSectionLength }}
            span(v-if='metronome.isPlaying && songChart.countIn.curCountInMeasure <= songChart.countIn.lengthMeasures') (counting in)
      div#songChart
        div.section-list(v-for='(section, index) in songChart.sections')
          div.section(
              v-bind:class='{ selected: index == songChart.curSectionIndex, hide: metronome.isPlaying && index < songChart.curSectionIndex }'
              v-on:click='metronomeSetStartingFromSection(index)')
            div.section.name {{ index + 1 }}: {{ section.name }} ({{ section.length }})
            div.subsection(
                v-for='(subsection, subindex) in section.subsections')
              div(v-bind:class='{ selected: index == songChart.curSectionIndex && subindex == songChart.curSubSectionIndex }')
                | {{ subsection.subname }} (
                span(v-if='subindex == songChart.curSubSectionIndex') {{ songChart.curSubSectionMeasure }} /
                | {{ subsection.sublength }})
        div
          a(v-on:click='songChartAppendSection()')
            | + Add section
